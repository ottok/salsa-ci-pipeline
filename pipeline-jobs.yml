# Copyright salsa-ci-team and others
# SPDX-License-Identifier: FSFAP
# Copying and distribution of this file, with or without modification, are
# permitted in any medium without royalty provided the copyright notice and
# this notice are preserved. This file is offered as-is, without any warranty.

# TODO: handle projects that need to extend the extract-source job

build:
  extends: .build-package

build i386:
  extends: .build-package-i386

build armel:
  extends: .build-package-armel

build armhf:
  extends: .build-package-armhf

build arm64:
  extends: .build-package-arm64

build ppc64el:
  extends: .build-package-ppc64el

build riscv64:
  extends: .build-package-riscv64

build source:
  extends: .build-source-only

test-build-any:
  extends: .test-build-package-any

test-build-all:
  extends: .test-build-package-all

test-build-twice:
  extends: .test-build-package-twice

test-build-validate-cleanup:
  extends: .test-build-validate-cleanup

test-build-profiles:
  extends: .test-build-package-profiles

test-crossbuild-arm64:
  extends: .test-crossbuild-package-arm64

reprotest:
  extends: .test-reprotest

lintian:
  extends: .test-lintian

autopkgtest:
  extends: .test-autopkgtest

autopkgtest i386:
  extends: .test-autopkgtest-i386

autopkgtest armel:
  extends: .test-autopkgtest-armel

autopkgtest armhf:
  extends: .test-autopkgtest-armhf

autopkgtest arm64:
  extends: .test-autopkgtest-arm64

blhc:
  extends: .test-blhc

piuparts:
  extends: .test-piuparts

missing-breaks:
  extends: .test-missing-breaks

rc-bugs:
  extends: .test-rc-bugs

wrap-and-sort:
  extends: .test-wrap-and-sort

licenserecon:
  extends: .test-licenserecon

aptly:
  extends: .publish-aptly

generate-build-rdep-config:
  extends: .generate-build-rdep-config

build-reverse-dependencies:
  extends: .test-build-reverse-dependencies

## Atomic Reprotest jobs
atomic-reprotest:
  extends: .test-reprotest
  rules:
    - if: $SALSA_CI_ENABLE_ATOMIC_REPROTEST =~ /^(1|yes|true)$/
  variables:
    SALSA_CI_REPROTEST_ARGS: '--variations=-all --variations=${VARIATION}'
  parallel:
    matrix:
      - VARIATION:
          - aslr
          - build_path
          - domain_host
          - environment
          - exec_path
          - fileordering
          - home
          - kernel
          - locales
          - num_cpus
          - time
          - timezone
          - umask
          - user_group
